
##########################
#   Grafana and InfluxDB
##########################
- name: Grafana status
  command: kubectl get svc monitoring-grafana --namespace=kube-system
  ignore_errors: yes
  no_log: True
  register: grafana

- name: InfluxDB status
  command: kubectl get svc monitoring-influxdb --namespace=kube-system
  ignore_errors: yes
  no_log: True
  register: heapster

- name: Cluster Profiling - Grafana| create grafana stack
  command: kubectl create --namespace=kube-system -f "/tmp/grafana.yaml"
  when: (grafana.rc != 0 or heapster.rc != 0)
