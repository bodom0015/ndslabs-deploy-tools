---

- name: OpenStack Volume
  become: false
  connection: local
  os_volume:
    state: present
    size: "{{ vol_size }}"
    display_name: "{{ inventory_hostname }}_{{vol_name}}"
  register: osvol

- name: Attach OS volume
  connection: local
  become: false
  os_server_volume:
    state: present
    server: "{{ inventory_hostname }}"
    volume: "{{ inventory_hostname }}_{{vol_name}}"
  register: glvol
  when: osvol.changed

- name: Attachment Path
  set_fact:
    block_dev: "{{ glvol.attachments[0].device }}"
  when: glvol.changed

